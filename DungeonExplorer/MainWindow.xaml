<Window x:Class="DungeonExplorer.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:conv="clr-namespace:DungeonExplorer.Converters"
        Title="Dungeon Explorer" Height="450" Width="800">
    <Window.Resources>
        <conv:BooleanToVisibilityConverter x:Key="BoolToVis" />
    </Window.Resources>
    <Grid Margin="16">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>            <!-- Game Over -->
            <RowDefinition Height="Auto"/>            <!-- Player -->
            <RowDefinition Height="Auto"/>            <!-- Current Room -->
            <RowDefinition Height="Auto"/>            <!-- Item in Room -->
            <RowDefinition Height="Auto"/>            <!-- Stats (Moves/Par/Score) -->
            <RowDefinition Height="*"/>               <!-- Inventory -->
            <RowDefinition Height="Auto"/>            <!-- Status + Controls -->
        </Grid.RowDefinitions>
        
        <!-- Menu Overlay -->
        <Border Background="#AA000000"
        CornerRadius="12"
        Padding="24"
        Visibility="{Binding ShowMenuOverlay, Converter={StaticResource BoolToVis}}"
        HorizontalAlignment="Center"
        VerticalAlignment="Center">
            <StackPanel HorizontalAlignment="Center">
                <TextBlock Text="{Binding OverlayTitle}"
                   FontSize="24"
                   FontWeight="Bold"
                   Foreground="White"
                   HorizontalAlignment="Center"
                   Margin="0,0,0,8"/>

                <TextBlock Text="{Binding OverlaySubtitle}"
                   FontSize="14"
                   Foreground="White"
                   TextWrapping="Wrap"
                   TextAlignment="Center"
                   Margin="0,0,0,16"/>

                <StackPanel Orientation="Horizontal"
                        Margin="0,0,0,12"
                        HorizontalAlignment="Center">
                    <TextBlock Text="Player Name:"
                        Foreground="White"
                        VerticalAlignment="Center"
                        Margin="0,0,8,0"/>
                    <TextBox Text="{Binding PlayerName, UpdateSourceTrigger=PropertyChanged}"
                        Width="160"/>
                </StackPanel>
                
                <StackPanel Orientation="Horizontal"
                        Margin="0,0,0,8"
                        HorizontalAlignment="Center">
                    <CheckBox Content="Show only my scores"
                        IsChecked="{Binding ShowOnlyMyScores}"
                        Foreground="White"/>
                </StackPanel>

                <GroupBox Header="Top Scores" Width="300" Margin="0,0,0,16">
                    <StackPanel>
                        <!-- Header Row -->
                        <StackPanel Orientation="Horizontal" Margin="4,0,4,4">
                            <TextBlock Text="Player" Width="120" Foreground="White" FontWeight="Bold"/>
                            <TextBlock Text="Score"  Width="60"  Foreground="White" FontWeight="Bold"/>
                            <TextBlock Text="Moves"  Width="50"  Foreground="White" FontWeight="Bold"/>
                            <TextBlock Text="Par"    Width="50"  Foreground="White" FontWeight="Bold"/>
                        </StackPanel>

                        <!-- Score Rows -->
                        <ItemsControl ItemsSource="{Binding TopScores}">
                            <ItemsControl.ItemTemplate>
                                <DataTemplate>
                                    <StackPanel Orientation="Horizontal" Margin="4">
                                        <TextBlock Text="{Binding PlayerName}" Width="120" Foreground="White"/>
                                        <TextBlock Text="{Binding Points}"     Width="60"  Foreground="White"/>
                                        <TextBlock Text="{Binding Moves}"      Width="50"  Foreground="White"/>
                                        <TextBlock Text="{Binding Par}"        Width="50"  Foreground="White"/>
                                    </StackPanel>
                                </DataTemplate>
                            </ItemsControl.ItemTemplate>
                        </ItemsControl>

                    </StackPanel>
                </GroupBox>


                <Button Content="New Game"
                Command="{Binding NewGameCommand}"
                Width="120"
                HorizontalAlignment="Center"
                Margin="0,0,0,8"
                Padding="4,2"/>

                <Button Content="Main Menu"
                Command="{Binding GoToMenuCommand}"
                Width="120"
                HorizontalAlignment="Center"
                Padding="4,2"
                Visibility="{Binding IsInGameOver, Converter={StaticResource BoolToVis}}"/>
            </StackPanel>
        </Border>

        <!-- Player info -->
        <StackPanel Orientation="Horizontal" Grid.Row="1" Margin="0,0,0,8">
            <TextBlock Text="Player: " FontWeight="Bold"/>
            <TextBlock Text="{Binding Player.Name}"/>
        </StackPanel>

        <!-- Current room -->
        <StackPanel Orientation="Horizontal" Grid.Row="2" Margin="0,0,0,8">
            <TextBlock Text="Current Room: " FontWeight="Bold"/>
            <TextBlock Text="{Binding Player.CurrentRoom}"/>
        </StackPanel>

        <!-- Item in the room -->
        <StackPanel Orientation="Horizontal" Grid.Row="3" Margin="0,0,0,8">
            <TextBlock Text="Item in this room: " FontWeight="Bold"/>
            <TextBlock Text="{Binding CurrentRoomItem}"/>
        </StackPanel>

        <!-- Stats: Moves, Par, Score -->
        <StackPanel Orientation="Horizontal" Grid.Row="4" Margin="0,0,0,8">
            <TextBlock Text="Moves: " FontWeight="Bold"/>
            <TextBlock Text="{Binding MoveCount}" Margin="0,0,16,0"/>

            <TextBlock Text="Par: " FontWeight="Bold"/>
            <TextBlock Text="{Binding Par}" Margin="0,0,16,0"/>

            <TextBlock Text="Score: " FontWeight="Bold"/>
            <TextBlock Text="{Binding Score}"/>
        </StackPanel>

        <!-- Inventory -->
        <GroupBox Grid.Row="5" Header="Inventory" Margin="0,8,0,0">
            <ItemsControl ItemsSource="{Binding Player.Inventory}">
                <ItemsControl.ItemTemplate>
                    <DataTemplate>
                        <TextBlock Text="{Binding}"/>
                    </DataTemplate>
                </ItemsControl.ItemTemplate>
            </ItemsControl>
        </GroupBox>

        <!-- Status + movement & pickup controls -->
        <StackPanel Grid.Row="6" Margin="0,16,0,0">
            <TextBlock Text="{Binding StatusMessage}"
                   TextWrapping="Wrap"
                   Margin="0,0,0,8"/>

            <Grid Margin="0,0,0,8">
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="Auto"/>
                </Grid.RowDefinitions>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="Auto"/>
                    <ColumnDefinition Width="Auto"/>
                    <ColumnDefinition Width="Auto"/>
                </Grid.ColumnDefinitions>

                <!-- Movement buttons -->
                <Button Grid.Row="0" Grid.Column="1" Content="North"
                    Command="{Binding MoveNorthCommand}"
                    Width="80" Margin="4"/>

                <Button Grid.Row="1" Grid.Column="0" Content="West"
                    Command="{Binding MoveWestCommand}"
                    Width="80" Margin="4"/>

                <Button Grid.Row="1" Grid.Column="1" Content="South"
                    Command="{Binding MoveSouthCommand}"
                    Width="80" Margin="4"/>

                <Button Grid.Row="1" Grid.Column="2" Content="East"
                    Command="{Binding MoveEastCommand}"
                    Width="80" Margin="4"/>
            </Grid>

            <!-- Pickup button -->
            <Button Content="Pick Up Item"
                Command="{Binding PickupItemCommand}"
                Width="120"
                HorizontalAlignment="Left"
                Margin="4,0,0,0"/>
        </StackPanel>
    </Grid>

</Window>
